<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chrome Extension v3 - Test Fixes</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 420px;
        margin: 0 auto;
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
      }
      .header {
        background: #007cba;
        color: white;
        padding: 15px;
        text-align: center;
      }
      .content {
        height: 600px;
        overflow: hidden;
      }
      .console {
        background: #1a1a1a;
        color: #00ff00;
        padding: 10px;
        font-family: monospace;
        font-size: 12px;
        height: 200px;
        overflow-y: auto;
        margin-top: 10px;
      }
      .error {
        color: #ff6b6b;
      }
      .success {
        color: #51cf66;
      }
      .info {
        color: #74c0fc;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h2>Chrome Extension v3 - Debug Test</h2>
        <p>Testing console error fixes</p>
      </div>
      <div class="content">
        <iframe src="index-v3.html" width="100%" height="100%" frameborder="0"></iframe>
      </div>
    </div>

    <div class="console" id="console">
      <div class="info">Console output will appear here...</div>
    </div>

    <script>
      // Capture console messages
      const consoleDiv = document.getElementById("console");
      const originalLog = console.log;
      const originalError = console.error;
      const originalWarn = console.warn;

      function addToConsole(message, type = "info") {
        const div = document.createElement("div");
        div.className = type;
        div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
        consoleDiv.appendChild(div);
        consoleDiv.scrollTop = consoleDiv.scrollHeight;
      }

      console.log = function (...args) {
        addToConsole(args.join(" "), "info");
        originalLog.apply(console, args);
      };

      console.error = function (...args) {
        addToConsole(args.join(" "), "error");
        originalError.apply(console, args);
      };

      console.warn = function (...args) {
        addToConsole(args.join(" "), "info");
        originalWarn.apply(console, args);
      };

      // Listen for iframe console messages
      window.addEventListener("message", function (event) {
        if (event.data && event.data.type === "console") {
          addToConsole(event.data.message, event.data.level);
        }
      });
    </script>
  </body>
</html>
